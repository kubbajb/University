---
title: "Zadanie 2"
author: "Jakub Anczyk"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r lib, include=FALSE}
library(ggplot2)
library(nortest)
```

## Polecenie

Za pomoc odpowiednich symulacji zbada moc testu Komogorowa-Smirnowa w przypadku, gdy rozwa偶ane pr贸bki danych pochodz w rozkad贸w 2 o r贸偶nej liczbie stopni swobody. Do cel贸w symulacji prosz przesun generowane dane tak, by miay t sam warto oczekiwan. Uzyskane wyniki nale偶y przedstawi na odpowiednich wykresach ilustrujcych moce test贸w z uwzgldnieniem:

- liczby danych (mo偶na rozwa偶a r贸偶ne liczebnoci w ka偶dej z pr贸bek),

- liczby stopni swobody


## Funkcje mierzce moc test贸w

```{r funkcje}

ks_df_power <- function(df, n){
  power <- c()
  
  for (i in 0:100){
    data <- rchisq(n = n, df = df)
    data <- data - mean(data)
    power[i] <- ks.test(data,"pchisq", n-1)$p.val
  }
  return (mean(power))
}

```

## Stworzenie danych dla test贸w

```{r dane}

data <- expand.grid(df = c(2, 3, 5, 7, 10, 15, 20, 30, 40, 60), n = c(3, 4, 5, 6, 7, 8, 9, 10))

```

## Zastosowanie funkcji do danych

```{r power}

data$ks_power <- mapply(ks_df_power, data$df, data$n)

```

## Stworzenie wykres贸w do wygenerowanych danych

```{r charts}

(ks_err <- ggplot(data, aes(x = df, y = ks_power, color = as.factor(n))) +
  geom_line() +
  labs(x = "df", y = "power") +
  scale_color_manual(values = rainbow(50)) +
  labs(color = "n", title = "rednia moc testu Koogomorowa-Smirnowa w zale偶noci od n i df") +
  geom_hline(yintercept = c(0.05, 0.15), lty = 2))

```