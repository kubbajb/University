---
title: "Zadanie 1"
author: "Jakub Anczyk"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r lib, include=FALSE}
library(ggplot2)
library(nortest)
```

## Polecenie

Za pomoc odpowiednich symulacji por贸wna moce testu Shapiro-Wilka, testu Komogorowa i testu
2 (z hipotez g贸wn, 偶e cecha ma rozkad normalny) w przypadku, gdy dane pochodz z rozkadu -Studenta lub innej klasy rozkad贸w symetrycznych (uwaga: 偶eby wyniki byy por贸wnywalne trzeba pamita o standaryzacji danych). 

Uzyskane wyniki nale偶y przedstawi na odpowiednich wykresach ilustrujcych moce test贸w z uwzgldnieniem:

- liczby danych,

- liczby stopni swobody generowanego rozkadu t-Studenta lub innych parametr贸w wybranego
rozkadu

## Funkcje mierzce moc test贸w

```{r funkcje}

sw_df_power <- function(df, n){
  mean(
    sapply(1:1000, 
           function(i) shapiro.test(rt(n,df))$p.val
    )
  )
}

ks_df_power <- function(df, n){
  mean(
    sapply(1:1000, 
           function(i) ks.test(rt(n,df),"pnorm")$p.val
    )
  )
}

chi_df_power <- function(df, n){
  mean(
    sapply(1:1000, 
           function(i) pearson.test(rt(n,df))$p.val
    )
  )
}

```

## Stworzenie danych dla test贸w

```{r dane}

data <- expand.grid(df = seq(1, 50, by=2), n = seq(5, 100, by=15))

```

## Zastosowanie funkcji do danych

```{r power}

data$sw_power <- mapply(sw_df_power, data$df, data$n)
data$ks_power <- mapply(ks_df_power, data$df, data$n)
data$chi_power <- mapply(chi_df_power, data$df, data$n)

```

## Stworzenie wykres贸w do wygenerowanych danych

```{r charts}

(sw <- ggplot(data, aes(x = df, y = sw_power, color = as.factor(n))) +
  geom_line() +
  labs(x = "df", y = "power") +
  scale_color_manual(values = rainbow(10)) +
  labs(color = "n", title = "Moc testu Shapiro-Wilka w zale偶noci od n i df") +
  geom_hline(yintercept = c(0.05, 0.5, 1), lty = 2))
 
(ks <- ggplot(data, aes(x = df, y = ks_power, color = as.factor(n))) +
  geom_line() +
  labs(x = "df", y = "power") +
  scale_color_manual(values = rainbow(10)) +
  labs(color = "n", title = "Moc testu Komogorowa-Smirnowa w zale偶noci od n i df") +
  geom_hline(yintercept = c(0.05, 0.5, 1), lty = 2))

(chi <- ggplot(data, aes(x = df, y = chi_power, color = as.factor(n))) +
  geom_line() +
  labs(x = "df", y = "power") +
  scale_color_manual(values = rainbow(10))  +
  labs(color = "n", title = "Moc testu Chi-kwadrat w zale偶noci od n i df") +
  geom_hline(yintercept = c(0.05, 0.5, 1), lty = 2))

```